{"ast":null,"code":"System.register(\"../../lib/Repository\", [], function () {\n  \"use strict\";\n\n  var __moduleName = \"../../lib/Repository\";\n\n  var thunkify = require(\"thunkify\");\n\n  var Emitter = require(\"events\").EventEmitter;\n\n  var cache = Symbol(\"cache\");\n\n  var Repository = function Repository(Actor, eventstore) {\n    this.Actor = Actor;\n    this.eventstore = eventstore;\n    this.getFromSnapShot = thunkify(this.eventstore.getFromSnapshot).bind(this.eventstore);\n    this.createSnapshot = thunkify(this.eventstore.createSnapshot).bind(this.eventstore);\n    this[$traceurRuntime.toProperty(cache)] = {};\n  };\n\n  $traceurRuntime.createClass(Repository, {\n    create: $traceurRuntime.initGeneratorFunction(function $__1(data) {\n      var actor;\n      return $traceurRuntime.createGeneratorInstance(function ($ctx) {\n        while (true) switch ($ctx.state) {\n          case 0:\n            actor = new this.Actor(data, true);\n            this[$traceurRuntime.toProperty(cache)][$traceurRuntime.toProperty(actor.id)] = actor;\n            this.emit(\"create\", actor);\n            $ctx.state = 4;\n            break;\n\n          case 4:\n            $ctx.returnValue = actor;\n            $ctx.state = -2;\n            break;\n\n          default:\n            return $ctx.end();\n        }\n      }, $__1, this);\n    }),\n    clear: function (id) {\n      delete this[$traceurRuntime.toProperty(cache)][$traceurRuntime.toProperty(id)];\n    },\n    getFromCache: function (id) {\n      return this[$traceurRuntime.toProperty(cache)][$traceurRuntime.toProperty(id)];\n    },\n    get: $traceurRuntime.initGeneratorFunction(function $__2(id) {\n      var actor, result, snapshot, stream, snap, history, historyv;\n      return $traceurRuntime.createGeneratorInstance(function ($ctx) {\n        while (true) switch ($ctx.state) {\n          case 0:\n            $ctx.state = (actor = this.getFromCache(id)) ? 1 : 2;\n            break;\n\n          case 1:\n            $ctx.returnValue = actor;\n            $ctx.state = -2;\n            break;\n\n          case 2:\n            $ctx.state = 5;\n            return this.getFromSnapShot(id);\n\n          case 5:\n            result = $ctx.sent;\n            $ctx.state = 7;\n            break;\n\n          case 7:\n            $ctx.state = (actor = this.getFromCache(id)) ? 8 : 9;\n            break;\n\n          case 8:\n            $ctx.returnValue = actor;\n            $ctx.state = -2;\n            break;\n\n          case 9:\n            snapshot = result[0];\n            stream = result[1];\n            snap = snapshot ? snapshot.data : {};\n            history = stream.events;\n            actor = new this.Actor();\n            actor.loadSnap(snap);\n            historyv = [];\n            history.forEach(function (e) {\n              historyv.push(e.payload);\n            });\n            actor.loadEvents(historyv);\n            this[$traceurRuntime.toProperty(cache)][$traceurRuntime.toProperty(actor.id)] = actor;\n            this.emit(\"reborn\", actor);\n            $ctx.state = 14;\n            break;\n\n          case 14:\n            $ctx.returnValue = actor;\n            $ctx.state = -2;\n            break;\n\n          default:\n            return $ctx.end();\n        }\n      }, $__2, this);\n    })\n  }, {}, Emitter);\n  module.exports = Repository;\n  return {};\n});\nSystem.get(\"../../lib/Repository\" + '');","map":{"version":3,"names":["System","register","__moduleName","thunkify","require","Emitter","EventEmitter","cache","Symbol","Repository","Actor","eventstore","getFromSnapShot","getFromSnapshot","bind","createSnapshot","$traceurRuntime","toProperty","createClass","create","initGeneratorFunction","$__1","data","actor","createGeneratorInstance","$ctx","state","id","emit","returnValue","end","clear","getFromCache","get","$__2","result","snapshot","stream","snap","history","historyv","sent","events","loadSnap","forEach","e","push","payload","loadEvents","module","exports"],"sources":["C:/Users/LeonyX/Documents/Blockchain/.vscode/loginpage/node_modules/domain/dist/lib/Repository.js"],"sourcesContent":["System.register(\"../../lib/Repository\", [], function() {\n  \"use strict\";\n  var __moduleName = \"../../lib/Repository\";\n  var thunkify = require(\"thunkify\");\n  var Emitter = require(\"events\").EventEmitter;\n  var cache = Symbol(\"cache\");\n  var Repository = function Repository(Actor, eventstore) {\n    this.Actor = Actor;\n    this.eventstore = eventstore;\n    this.getFromSnapShot = thunkify(this.eventstore.getFromSnapshot).bind(this.eventstore);\n    this.createSnapshot = thunkify(this.eventstore.createSnapshot).bind(this.eventstore);\n    this[$traceurRuntime.toProperty(cache)] = {};\n  };\n  ($traceurRuntime.createClass)(Repository, {\n    create: $traceurRuntime.initGeneratorFunction(function $__1(data) {\n      var actor;\n      return $traceurRuntime.createGeneratorInstance(function($ctx) {\n        while (true)\n          switch ($ctx.state) {\n            case 0:\n              actor = new this.Actor(data, true);\n              this[$traceurRuntime.toProperty(cache)][$traceurRuntime.toProperty(actor.id)] = actor;\n              this.emit(\"create\", actor);\n              $ctx.state = 4;\n              break;\n            case 4:\n              $ctx.returnValue = actor;\n              $ctx.state = -2;\n              break;\n            default:\n              return $ctx.end();\n          }\n      }, $__1, this);\n    }),\n    clear: function(id) {\n      delete this[$traceurRuntime.toProperty(cache)][$traceurRuntime.toProperty(id)];\n    },\n    getFromCache: function(id) {\n      return this[$traceurRuntime.toProperty(cache)][$traceurRuntime.toProperty(id)];\n    },\n    get: $traceurRuntime.initGeneratorFunction(function $__2(id) {\n      var actor,\n          result,\n          snapshot,\n          stream,\n          snap,\n          history,\n          historyv;\n      return $traceurRuntime.createGeneratorInstance(function($ctx) {\n        while (true)\n          switch ($ctx.state) {\n            case 0:\n              $ctx.state = (actor = this.getFromCache(id)) ? 1 : 2;\n              break;\n            case 1:\n              $ctx.returnValue = actor;\n              $ctx.state = -2;\n              break;\n            case 2:\n              $ctx.state = 5;\n              return this.getFromSnapShot(id);\n            case 5:\n              result = $ctx.sent;\n              $ctx.state = 7;\n              break;\n            case 7:\n              $ctx.state = (actor = this.getFromCache(id)) ? 8 : 9;\n              break;\n            case 8:\n              $ctx.returnValue = actor;\n              $ctx.state = -2;\n              break;\n            case 9:\n              snapshot = result[0];\n              stream = result[1];\n              snap = snapshot ? snapshot.data : {};\n              history = stream.events;\n              actor = new this.Actor();\n              actor.loadSnap(snap);\n              historyv = [];\n              history.forEach(function(e) {\n                historyv.push(e.payload);\n              });\n              actor.loadEvents(historyv);\n              this[$traceurRuntime.toProperty(cache)][$traceurRuntime.toProperty(actor.id)] = actor;\n              this.emit(\"reborn\", actor);\n              $ctx.state = 14;\n              break;\n            case 14:\n              $ctx.returnValue = actor;\n              $ctx.state = -2;\n              break;\n            default:\n              return $ctx.end();\n          }\n      }, $__2, this);\n    })\n  }, {}, Emitter);\n  module.exports = Repository;\n  return {};\n});\nSystem.get(\"../../lib/Repository\" + '');\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}