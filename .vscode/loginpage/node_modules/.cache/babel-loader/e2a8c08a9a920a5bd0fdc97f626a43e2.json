{"ast":null,"code":"var Eventstore = require('./lib/eventstore'),\n    Base = require('./lib/base'),\n    _ = require('lodash'),\n    debug = require('debug')('eventstore'),\n    StoreEventEmitter = require('./lib/storeEventEmitter');\n\nfunction exists(toCheck) {\n  var _exists = require('fs').existsSync || require('path').existsSync;\n\n  if (require('fs').accessSync) {\n    _exists = function (toCheck) {\n      try {\n        require('fs').accessSync(toCheck);\n\n        return true;\n      } catch (e) {\n        return false;\n      }\n    };\n  }\n\n  return _exists(toCheck);\n}\n\nfunction getSpecificStore(options) {\n  options = options || {};\n  options.type = options.type || 'inmemory';\n\n  if (_.isFunction(options.type)) {\n    return options.type;\n  }\n\n  options.type = options.type.toLowerCase();\n  var dbPath = __dirname + \"/lib/databases/\" + options.type + \".js\";\n\n  if (!exists(dbPath)) {\n    var errMsg = 'Implementation for db \"' + options.type + '\" does not exist!';\n    console.log(errMsg);\n    debug(errMsg);\n    throw new Error(errMsg);\n  }\n\n  try {\n    var db = require(dbPath);\n\n    return db;\n  } catch (err) {\n    if (err.message.indexOf('Cannot find module') >= 0 && err.message.indexOf(\"'\") > 0 && err.message.lastIndexOf(\"'\") !== err.message.indexOf(\"'\")) {\n      var moduleName = err.message.substring(err.message.indexOf(\"'\") + 1, err.message.lastIndexOf(\"'\"));\n      var msg = 'Please install module \"' + moduleName + '\" to work with db implementation \"' + options.type + '\"!';\n      console.log(msg);\n      debug(msg);\n    }\n\n    throw err;\n  }\n}\n\nmodule.exports = function (options) {\n  options = options || {};\n  var Store;\n\n  try {\n    Store = getSpecificStore(options);\n  } catch (err) {\n    throw err;\n  }\n\n  var eventstore = new Eventstore(options, new Store(options));\n\n  if (options.emitStoreEvents) {\n    var storeEventEmitter = new StoreEventEmitter(eventstore);\n    storeEventEmitter.addEventEmitter();\n  }\n\n  return eventstore;\n};\n\nmodule.exports.Store = Base;","map":{"version":3,"names":["Eventstore","require","Base","_","debug","StoreEventEmitter","exists","toCheck","_exists","existsSync","accessSync","e","getSpecificStore","options","type","isFunction","toLowerCase","dbPath","__dirname","errMsg","console","log","Error","db","err","message","indexOf","lastIndexOf","moduleName","substring","msg","module","exports","Store","eventstore","emitStoreEvents","storeEventEmitter","addEventEmitter"],"sources":["C:/Users/LeonyX/Documents/Blockchain/.vscode/loginpage/node_modules/eventstore/index.js"],"sourcesContent":["var Eventstore = require('./lib/eventstore'),\n  Base = require('./lib/base'),\n  _ = require('lodash'),\n  debug = require('debug')('eventstore'),\n  StoreEventEmitter = require('./lib/storeEventEmitter');\n\nfunction exists(toCheck) {\n  var _exists = require('fs').existsSync || require('path').existsSync;\n  if (require('fs').accessSync) {\n    _exists = function (toCheck) {\n      try {\n        require('fs').accessSync(toCheck);\n        return true;\n      } catch (e) {\n        return false;\n      }\n    };\n  }\n  return _exists(toCheck);\n}\n\nfunction getSpecificStore(options) {\n  options = options || {};\n\n  options.type = options.type || 'inmemory';\n\n  if (_.isFunction(options.type)) {\n    return options.type;\n  }\n\n  options.type = options.type.toLowerCase();\n\n  var dbPath = __dirname + \"/lib/databases/\" + options.type + \".js\";\n\n  if (!exists(dbPath)) {\n    var errMsg = 'Implementation for db \"' + options.type + '\" does not exist!';\n    console.log(errMsg);\n    debug(errMsg);\n    throw new Error(errMsg);\n  }\n\n  try {\n    var db = require(dbPath);\n    return db;\n  } catch (err) {\n\n    if (err.message.indexOf('Cannot find module') >= 0 &&\n      err.message.indexOf(\"'\") > 0 &&\n      err.message.lastIndexOf(\"'\") !== err.message.indexOf(\"'\")) {\n\n      var moduleName = err.message.substring(err.message.indexOf(\"'\") + 1, err.message.lastIndexOf(\"'\"));\n      var msg = 'Please install module \"' + moduleName +\n        '\" to work with db implementation \"' + options.type + '\"!';\n      console.log(msg);\n      debug(msg);\n    }\n\n    throw err;\n  }\n}\n\nmodule.exports = function(options) {\n  options = options || {};\n\n  var Store;\n\n  try {\n    Store = getSpecificStore(options);\n  } catch (err) {\n    throw err;\n  }\n\n  var eventstore = new Eventstore(options, new Store(options));\n\n  if (options.emitStoreEvents) {\n    var storeEventEmitter = new StoreEventEmitter(eventstore);\n    storeEventEmitter.addEventEmitter();\n  }\n\n  return eventstore;\n};\n\nmodule.exports.Store = Base;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}